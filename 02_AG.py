################################################
############# ANALYTIC GEOMETRY ################
################################################

# my notes with examples and code for analytic geometry , requires knowledge of 01_LA.py

# 1. Norms
import numpy as np

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ’¡ NORM = generalized length of a vector
# âˆ¥xâˆ¥ is a scalar â‰¥ 0 that tells you how "big" or "long" a vector x is
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Example vector
x = np.array([3, 4])  # classic 3-4-5 triangle vector

# â„“2 norm (Euclidean norm) = sqrt(x1Â² + x2Â² + ... + xnÂ²)
# This is the "default" norm unless stated otherwise
euclidean_norm = np.linalg.norm(x)
print("âˆ¥xâˆ¥â‚‚ =", euclidean_norm)  # output: 5.0

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” PROPERTY 1: Absolute Homogeneity
# âˆ¥Î»xâˆ¥ = |Î»| * âˆ¥xâˆ¥
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Î» = -2
lhs = np.linalg.norm(Î» * x)
rhs = abs(Î») * np.linalg.norm(x)
print("Homogeneity holds:", np.isclose(lhs, rhs))  # should be True

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” PROPERTY 2: Triangle Inequality
# âˆ¥x + yâˆ¥ â‰¤ âˆ¥xâˆ¥ + âˆ¥yâˆ¥
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
y = np.array([1, -1])
left = np.linalg.norm(x + y)
right = np.linalg.norm(x) + np.linalg.norm(y)
print("Triangle inequality holds:", left <= right)  # should be True

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” PROPERTY 3: Positive Definiteness
# âˆ¥xâˆ¥ â‰¥ 0, and âˆ¥xâˆ¥ = 0 â‡” x = 0
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
zero_vector = np.array([0, 0, 0])
norm_zero = np.linalg.norm(zero_vector)
print("Positive definiteness holds:", norm_zero == 0)  # True only if vector is zero

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”„ BONUS: Other norms
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# â„“1 norm = Manhattan distance = sum of absolute values
l1_norm = np.linalg.norm(x, ord=1)  # âˆ¥xâˆ¥â‚ = |3| + |4| = 7
print("âˆ¥xâˆ¥â‚ =", l1_norm)

# â„“âˆ norm = max absolute value in vector
linf_norm = np.linalg.norm(x, ord=np.inf)  # max(|3|, |4|) = 4
print("âˆ¥xâˆ¥âˆ =", linf_norm)

# in simple words
"""
A norm is a function that tells us how long a vector is - consider it to be a measuring tape in any vector space

A norm âˆ¥Â·âˆ¥ is a function:

 âˆ¥Â·âˆ¥ : V â†’ â„
x â†¦ âˆ¥xâˆ¥ 

It must satisfy 3 properties for all scalars Î» and all vectors x, y in V:

1. Absolute homogeneity : âˆ¥Î»xâˆ¥ = |Î»| âˆ¥xâˆ¥
    scaling a vector scales its norm by the absolute value of the scalar.

2. Triangle Inequality : âˆ¥x + yâˆ¥ â‰¤ âˆ¥xâˆ¥ + âˆ¥yâˆ¥
    the norm of a sum is less than or equal to the sum of the norms , or in simple words , going from A to B to C is never shorter than directly from A to C.

3. Positive definiteness : âˆ¥xâˆ¥ â‰¥ 0, and âˆ¥xâˆ¥ = 0 â‡” x = 0
    
        the norm is always non-negative and is zero if and only if the vector itself is the zero vector , or in simple words , length is always non-negative, and only zero when the vector is zero.

"""

"""
::::--=+=+*###++++**
.:-=++****+*#%#+===#
-==***#%%%%%%##**++#
=+++*%@%%%%%@@%#***#
=:-+#@@%%%%%%%@*++=+
=-:-#%*#*++**=%%+---
*+=+#*---:.:--+*----
%#*=**#=....=#+----=
@@@%*-*=+**+=*--===+
@@@@#=*#%%@%##=+###%
##%%%%%%%%%%%%%%####
"""
import numpy as np

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“Œ EXAMPLE 3.1 - MANHATTAN NORM (â„“1 norm)
# âˆ¥xâˆ¥â‚ = sum of absolute values of the vector components
# Think: total blocks you'd walk in a grid-like city like NYC
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

x1 = np.array([3, -4])  # sample vector
manhattan_norm = np.sum(np.abs(x1))  # manual calc
print("âˆ¥xâˆ¥â‚ (Manhattan) =", manhattan_norm)  # â†’ 7

# using numpy's built-in version:
l1_np = np.linalg.norm(x1, ord=1)
print("âˆ¥xâˆ¥â‚ via np =", l1_np)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ“Œ EXAMPLE 3.2 - EUCLIDEAN NORM (â„“2 norm)
# âˆ¥xâˆ¥â‚‚ = sqrt(sum of squares) = usual "distance from origin"
# Think: crow-flies distance in 2D/3D space
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

x2 = np.array([3, 4])
euclidean_norm = np.sqrt(np.sum(x2**2))  # manual
print("âˆ¥xâˆ¥â‚‚ (Euclidean) =", euclidean_norm)  # â†’ 5

# using numpy:
l2_np = np.linalg.norm(x2)  # default is ord=2
print("âˆ¥xâˆ¥â‚‚ via np =", l2_np)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ’¡ Summary:
# â„“1 norm = âˆ‘|xi| â†’ grid walk distance
# â„“2 norm = sqrt(xáµ€x) â†’ Pythagorean distance
# both are valid "lengths" in vector space, used in diff contexts
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# animation for this is at 02_AG/euc_man.py

"""
::::--=+=+*###++++**
.:-=++****+*#%#+===#
-==***#%%%%%%##**++#
=+++*%@%%%%%@@%#***#
=:-+#@@%%%%%%%@*++=+
=-:-#%*#*++**=%%+---
*+=+#*---:.:--+*----
%#*=**#=....=#+----=
@@@%*-*=+**+=*--===+
@@@@#=*#%%@%##=+###%
##%%%%%%%%%%%%%%####
"""

# heads up : throughout the book it is suggested to use euclidean and hence i will be following the same in the script unless mentioned otherwise

####################
# INNER PRODUCTS
####################

# 1. Dot Product

# inner products give us a way to talk about:
# - length (norms)
# - angles
# - projections
# - orthogonality (whether vectors are perpendicular)

# the most common inner product in R^n is the dot product:
#    x â‹… y = sum(x_i * y_i)
# this gives us a scalar (just a number).

# if dot(x, y) == 0 â†’ x and y are orthogonal (perpendicular).
# if dot(x, y) > 0 â†’ acute angle
# if dot(x, y) < 0 â†’ obtuse angle

# dot product is also useful for:
# - projecting vectors
# - cosine similarity
# - checking alignment between directions

# define two vectors
x = np.array([1, 2])
y = np.array([3, 4])

# dot product using numpy
dot = np.dot(x, y)
print(f"dot(x, y): {dot}")  # should be 1*3 + 2*4 = 11

# norm (length) of vectors
norm_x = np.linalg.norm(x)
norm_y = np.linalg.norm(y)

# angle between x and y using cosine formula
cos_theta = dot / (norm_x * norm_y)
angle_rad = np.arccos(cos_theta)
angle_deg = np.degrees(angle_rad)

print(f"angle between x and y (deg): {angle_deg:.2f}")

# check orthogonality
if np.isclose(dot, 0):
    print("vectors are orthogonal")
else:
    print("vectors are NOT orthogonal")


# General Inner Products

# an inner product is just a rule that:
# - takes in 2 vectors
# - spits out a number
# - behaves nicely with addition, scalar multiplication, symmetry, and positivity

# if it follows:
# 1. linear in both inputs (bilinear)
# 2. symmetric â†’ âŸ¨x, yâŸ© = âŸ¨y, xâŸ©
# 3. positive definite â†’ âŸ¨x, xâŸ© > 0 for x â‰  0
# then congrats, it's an inner product space

# create a symmetric, positive-definite matrix A
A = np.array([[2, 0],
              [0, 3]])

# define a custom inner product using A: âŸ¨x, yâŸ© = xáµ€Ay
def inner_product(x, y):
    return np.dot(x, A @ y)

# test vectors
x = np.array([1, 2])
y = np.array([3, 4])

# use our custom inner product
print(f"âŸ¨x, yâŸ© = {inner_product(x, y)}")

# check symmetry
print(f"âŸ¨x, yâŸ© == âŸ¨y, xâŸ©? {inner_product(x, y) == inner_product(y, x)}")

# check positive definiteness
print(f"âŸ¨x, xâŸ© = {inner_product(x, x)}")  # should be > 0

# in simple words
# the thing is that dot product only outputs a numebr but general inner product is an upgrade , its a custom rule capable of measuring:
# length
# angles 
# orthogonality
# but in more expanded space not restricted to R^n

# whats needed to make it an inner product

"""
your custom rule (aka function) must:

1 . be bilinear â†’ linear in both inputs

2. be symmetric â†’ order doesnâ€™t matter (âŸ¨x, yâŸ© = âŸ¨y, xâŸ©)

3. be positive definite â†’ âŸ¨x, xâŸ© is always > 0 unless x is zero
"""

# Example - Inner Product That Is Not the Dot Product
# Define a custom inner product as per the given formula:
# âŸ¨x, yâŸ© := x1y1 âˆ’ (x1y2 + x2y1) + 2x2y2

def custom_inner_product(x, y):
    return x[0] * y[0] - (x[0] * y[1] + x[1] * y[0]) + 2 * x[1] * y[1]

# Test vectors
x = np.array([1, 2])
y = np.array([3, 4])

# Compute the custom inner product
result = custom_inner_product(x, y)
print(f"âŸ¨x, yâŸ© (custom) = {result}")

# Verify symmetry: âŸ¨x, yâŸ© == âŸ¨y, xâŸ©
symmetric = custom_inner_product(x, y) == custom_inner_product(y, x)
print(f"Symmetry holds? {symmetric}")

# Verify positive definiteness: âŸ¨x, xâŸ© > 0 for x â‰  0
positive_definite = custom_inner_product(x, x) > 0
print(f"Positive definiteness holds? {positive_definite}")

# animation at 02_AG/in_po.py

"""
::::--=+=+*###++++**
.:-=++****+*#%#+===#
-==***#%%%%%%##**++#
=+++*%@%%%%%@@%#***#
=:-+#@@%%%%%%%@*++=+
=-:-#%*#*++**=%%+---
*+=+#*---:.:--+*----
%#*=**#=....=#+----=
@@@%*-*=+**+=*--===+
@@@@#=*#%%@%##=+###%
##%%%%%%%%%%%%%%####
"""




















"""

------++=-----------::---::::--:::::::::::::::---+++++**#*#######*=++++++++====++===+++++===+++++++=
:::::-------::::::::-----------::+*=--:::::::::-**+*++**#*########****++++==+++++++=++*+++++++++++++
:::::::::::::::::::----------:::=*##***-:::::**###*****#**####%#####***+++++++***+++*************+**
:::::::::::::::::::---------:::-**##***#*::+##**#*#**+****###########**+++********+*******#######**#
................:---------:::::+**#****###*#**#****#*****##**########*+*******++++=++===+*+++###***#
................:--==---::::::=*******###%%###****##*****##########%#********+=======--------=*##*#*
.............:::-++##***-::::-*****#*####%%########*****###########%%#*******+=======--------==*####
.........:::----+++*#*++#+.:##*******##############****###########%%%%%###**++++======-------==*####
..:....:---=====+++*#***####*#*****#########*=-::::-=*############%%%%%%%#**++++++=======---===+####
.::::::--======++++**##*######********+:..:-=+*####*+=-::.:=*#####%%%%%%#*******+++====----====+####
:::::--=====---+++******#####*****+-::+#%%@@@@@@@@@@@@@@%%%*-::+##%%%%%%#*******+++++==---====+#####
:----==+=--:::+++***#***##*##***-:-#%%@@@@@@@@@@@@@@@@@@@@@%%%%*::*%%%%%%#******+++++++=--===+*#####
--===+=----.:-*+*****####*###+::*%@@@@@@%%%%%%%%%%%%%%%%%%%%@@@@%%=:+%%%%%#*******++++++=====+*#####
-==++=====-+#***+******##***::#%@@@@%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@%+:#%%%%##*********++=====+######
======++==****++++**+**#**=:#%@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@%-=%%%%%#*********+++==+*######
==++++++*#***++++++******=-%@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@+=%%%%#**********+++***######
=+++++++****++++++******==%@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@**%%%##*#####***+=+****#####
==++++++**++++++++*****+-%@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@=######***###**+=+******###
--==+++=+++++++++******-%@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@%+###*****###**+=+*****####
---:-=====+++++++******+@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@*###*+++*###*+=++*********
::..:-----=+++++++****=%@@@@@@@@@%%%%%%%%%##%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@%**+++++*###*+=++++******+
--::-::::-=====+++***+=@@@@@@@@@@@@%%%%%%%#####%%%%%%%%%%%%@@@@@@@@@@@@@@@@+++++++*##*===+++++++++++
===-:...::-::-==+++++++@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@%%@@@#++++++*#*+==========++++
+++=-::.:::::-===++++++@@@@@@@@@@@@@@@@@@@@%%%%%%%%%##****###**+%+***%@@@@+**===++**+===============
++++=--::::::---==+++=+@@@@@@@@@@@@@@@@%%%##******+++++#+*+++++**++**#@@@@@@%*==+*#*===============-
==++==--:::::::--=====*@@@@@@@@@@@@####****+++++++++++++++*++++++++++*%@@@@@@%*+**+=======---------:
===++==-:::::::--=====+@@@@@@%%#*++**+++%*++++++======+++++#*+++*+++++#%%@@@@@%***======-----:::--::
---++==--::::::--=====*%%@@@@%**+++***%*****+=========++*****#*+*-=+=-*#%@@@@@@#+======-----::-====:
--+++==---:::::---==-=@@@@@@%#+*++=%%@@%%%@%++========++@@%%@@@##:-:::*##%@@@@@%======------:::::-::
****++==--::::----+==%@@@@%%#*+++=*@@**%%%%+%+=========**%%%%*+@@+:..:*%##@@@@@@---=--------:::::=::
#****++=---::---=-=-%@@@@@###*=-::++#+=*==+==============+-=*=+*+::::-+++***#*@*-----------:-::::+::
#*****++++=-----=--=%@*#%####*=-::-+==++++====-:.......:-==+++-:=::::+*******@@:-----==-------:::=-:
#*****++==----=-=--+@@@@#******=-::=:-----::.....::........:::::-+::=+**++#@@@::--==--=-----:--::+::
******+++-:-=----=-+@@@@@@@*--+*--==::..........::.............-+--=*-:+*#@@@=::--=---=-------=::+:-
%%%%#*+=++==%*-----=%@@@@@@***#+*--#=:........................:=#-=#####+#%@%..:-:----=---=---==:+-+
%%%##*+=**%%@@##@@%##@@@@@@*****+##+=::.......................-==%%+*##*+#.+=...--:------------+-++-
%%%%#*+==*%%@@%=:::--+@@@@%******###*-:.......................-*%#****#+=*.#*.::-::--:--:-:---:-**-:
%%%%@%#%%##%@+::--:=-:%@-:#++***%###=:=......................--=%#*%#*#==+.@=:::-::--:--:-:-----**-:
%%%%@%*%%#-=*=#*---=-:#=::*+-++*%###=..=:..................:+..=#**%#**==+.:::::-::-------:----:++::
@%%@@%##%%+%#+*#%#**=:%=::+=-=+*%#*#=....-=:.........:...-=....=#**%#*+===::::::=::-------------*=:-
@@@@@@@@@@@@@@@@@@@@%:%+::=-:-+*##*#=......##=::......:#%:.....=#**%#*-==-:::---=---------------*=--
@@@@@@@@@@@@@@@@@@@@#:%*=-::-:=#%#*#=......*###%*=-+%##**:...:.+%**%%+-=--::----=--==--====+====*=-=
@@@@@@@@@@@@@@@@@@@@@--=**-:-:=*#**#=--:+#%#**#######*++*##*-::*#**##+:-::--=======+======+=====*+=+
@%@%@@@@@@%%%%@@@@@@%--+*+=:::=*+***=-+=%@@#++**#**++++*#@@%*+:*-****+:-::===+++++++=====+++++++#+=+
%%%%%%%%%%%%@@@@@@@@@=*++-=-::+++*#*+=*+@@%@%%%%%%%%%%%%%%@@++=*=****+::::-+++++===*====++-=+++*##+*
@@@@@@@@@@@@@@@@@@@@@=+*+=-::-++******#+%@@@%@@@@@@@@@@@@@@#=*+**%***+-=::=-====*+=+=++##*##%%###*##
@@@@@@@@@@@@@@@@@@@@@+**=*:::=+**%#%==#*%@@@%%@@%@%@@@@@@@%%=#++*%#***-=-:--==**###***#%#==%%@%####%
@@@@@@@@@@@@@@@@@@@@@***++::-+*##+-=%@@%#%@@#%@%%%@@@@@%%%%%=*@%==+#**+==-:*-#%@@@@@@@#=+%=*%%%%%@@@
@@@@@@@@@@@@@@@@@@@@@##=*-:=#++%%*+@@@%@@@@@###########**#%@@@@@%=%%#=+*==::++%@@@@@@%+*#%#*##%%#@@@
%%#=#%@@@@@@@@@@@@@@@#**%*=#@@@%%+@@%@%%@@@@@@%@@@@@@@%@@@@@@%%@@#*%@@@#==#-==%%%%%%%++#%#%##%###%%%
%%%%+*%%%@@@@@@@@@@%#*+*%@@@@%%%%%@%%%%%@@@@@@#%@@@@%##%@@@%%%%@@@#%%%@@@@%+=*#*##%%%+**#%%#%@%*##%%
%%#*+++=%%%%%%%@@%++%@@@@%%%%%%%%%%%%%%%%@@@@%*#%%@@@##%@@@@%%%%@@%%%%@%%%@@@%*=+##%%##*+#@%%%+*#%%%
%%%##%#+=######=*@@@@@@%%%%%%%%%%%%%%%%%%%@@@@*#%%%@@**#@@@%%%%%%@@%%%%%%%%%%%%%@#==%%%%***%#++%%##*
#%#**%%*++****%@@@@@%%%%%%%%%%%%%%%%%%%%%%%@@@*#***#%**#@@%%%%%%@@@@%%%%%%%%%%%%%%%%*#*%%%#%%#***%##
*%###%#***#*%@@@@@@@%%%%%%%%%%%%%%%%%%%%%%%%@@*%@@@@@##%@%%%%%%%@@@@%%%%%%%%%%%%%%%%@@%=%@%%@@##%###

"""